#include <stdio.h> 
#include <openssl/bn.h> 
#define NBITS 256 

void printBN(char *msg, BIGNUM * a){ 
	char * number_str = BN_bn2hex(a); 
	printf("%s %s\n", msg, number_str); 
	OPENSSL_free(number_str); 
}

int main(){

	//Variables 
	BN_CTX *ctx = BN_CTX_new();
	BIGNUM *S = BN_new(); 
	BIGNUM *e = BN_new(); 
	BIGNUM *M = BN_new(); 
	BIGNUM *n = BN_new();
	

	//Initialize the variables with their values 
	BN_hex2bn(&n, "B611028B1EE3A1779B3BDCBF943EB795A7403CA1FD82F97D32068271F6F68C7FFBE8DBBC6A2E9797A38C4BF92BF6B1F9CE841DB1F9C597DEEFB9F2A3E9BC12895EA7AA52ABF82327CBA4B19C63DBD7997EF00A5EEB68A6F4C65A470D4D1033E34EB113A3C8186C4BECFC0990DF9D6429252307A1B4D23D2E60E0CFD20987BBCD48F04DC2C27A888ABBBACF5919D6AF8FB007B09E31F182C1C0DF2EA66D6C190EB5D87E261A45033DB079A49428AD0F7F26E5A808FE96E83C689453EE833A882B159609B2E07A8C2E75D69CEBA756648F964F68AE3D97C2848FC0BC40C00B5CBDF687B3356CAC18507F84E04CCD92D320E933BC5299AF32B529B3252AB448F972E1CA64F7E682108DE89DC28A88FA38668AFC63F901F978FD7B5C77FA7687FAECDFB10E799557B4BD26EFD601D1EB160ABB8E0BB5C5C58A55ABD3ACEA914B29CC19A432254E2AF16544D002CEAACE49B4EA9F7C83B0407BE743ABA76CA38F7D8981FA4CA5FFD58EC3CE4BE0B5D8B38E45CF76C0ED402BFD530FB0A7D53B0DB18AA203DE31ADCC77EA6F7B3ED6DF912212E6BEFAD832FC1063145172DE5DD61693BD296833EF3A66EC078A26DF13D757657827DE5E491400A2007F9AA821B6A9B195B0A5B90D1611DAC76C483C40E07E0D5ACD563CD19705B9CB4BED394B9CC43FD255136E24B0D671FAF4C1BACCED1BF5FE8141D800983D3AC8AE7A9837180595");
	BN_hex2bn(&e, "10001");
	BN_hex2bn(&S, "e8e6ea3b55f0501859692098ec67ae3f1aca9c8f554734c228f2feb30037c8bc9adc5c1abb467c52bfd8579a9c94f38c774991e65b1a4aa4414cdab92cd00c6a39dd178b08191e07404b4e5c477683f55e959752380e257085345bf900e1d492843afcd1bef4df11a71179ed54ab4fdd95c55f238b145f66a33e5fdd9e92a16dc235f07d4c4450c14a8dd617dc7f6f0e639d64349d587ce8a7cfe5a839296d33c8a4b9ae53eb6fa8f617a61192bc65d192368f66204f34dce38fb64edd28990a3319551e9959e361d4a40d163ad434d7471f37de972c7a52ac08756df4d7176723f8f56a220a0a1de4e237f444afccb5a798a0dfb7e782b296337685be16918d"); 

	BN_mod_exp(M, S, e, n, ctx);
	printBN("Verify Signature: ", M);	

	return 0;
}